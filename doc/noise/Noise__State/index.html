<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Noise__State (noise.Noise__State)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">noise</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Noise__State</span></h1></header><p><code class="code">HandshakeState</code> as defined in v34 5.3.</p><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-make"><a href="#val-make" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>make : name:string <span class="keyword">&#8209;&gt;</span> pattern:<a href="../Noise/Pattern/index.html#type-t">Noise.Pattern.t</a> <span class="keyword">&#8209;&gt;</span> is_initiator:bool <span class="keyword">&#8209;&gt;</span> hash:<a href="../Noise/Hash/index.html#type-t">Noise.Hash.t</a> <span class="keyword">&#8209;&gt;</span> dh:<a href="../Noise/Dh/index.html#type-t">Noise.Dh.t</a> <span class="keyword">&#8209;&gt;</span> cipher:<a href="../Noise/Cipher/index.html#type-t">Noise.Cipher.t</a> <span class="keyword">&#8209;&gt;</span> s:<a href="../Noise/Private_key/index.html#type-t">Noise.Private_key.t</a> option <span class="keyword">&#8209;&gt;</span> rs:<a href="../Noise/Public_key/index.html#type-t">Noise.Public_key.t</a> option <span class="keyword">&#8209;&gt;</span> e:<a href="../Noise/Private_key/index.html#type-t">Noise.Private_key.t</a> option <span class="keyword">&#8209;&gt;</span> psk:Cstruct.t option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"></div></div><div class="spec val" id="val-e_pub"><a href="#val-e_pub" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>e_pub : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Noise/Public_key/index.html#type-t">Noise.Public_key.t</a> option</code></div><div class="doc"><p>The public key corresponding to <code class="code">e</code>.</p></div></div><div class="spec val" id="val-set_re"><a href="#val-set_re" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set_re : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Noise/Public_key/index.html#type-t">Noise.Public_key.t</a> <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a>, string) Pervasives.result</code></div><div class="doc"><p>Set <code class="code">re</code>, returning an error if was set before.</p></div></div><div class="spec val" id="val-s_pub"><a href="#val-s_pub" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>s_pub : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Noise/Public_key/index.html#type-t">Noise.Public_key.t</a> option</code></div><div class="doc"><p>The public key corresponding to <code class="code">s</code>.</p></div></div><div class="spec val" id="val-set_rs"><a href="#val-set_rs" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set_rs : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Noise/Public_key/index.html#type-t">Noise.Public_key.t</a> <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a>, string) Pervasives.result</code></div><div class="doc"><p>Set <code class="code">rs</code>, returning an error if was set before.</p></div></div><div class="spec val" id="val-is_initiator"><a href="#val-is_initiator" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>is_initiator : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"></div></div><div class="spec val" id="val-pattern"><a href="#val-pattern" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pattern : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Noise/Pattern/index.html#type-t">Noise.Pattern.t</a></code></div><div class="doc"></div></div><div class="spec type" id="type-key_type"><a href="#type-key_type" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>key_type</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-key_type.Static" class="anchored"><td class="def constructor"><a href="#type-key_type.Static" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Static</span></code></td></tr><tr id="type-key_type.Ephemeral" class="anchored"><td class="def constructor"><a href="#type-key_type.Ephemeral" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Ephemeral</span></code></td></tr></table><code></code></div><div class="doc"></div></div><div class="spec val" id="val-mix_hash"><a href="#val-mix_hash" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mix_hash : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Delegate <code class="code">mix_hash</code> on the underlying <code class="code">Symmetric_state.t</code>.</p></div></div><div class="spec val" id="val-mix_hash_and_psk"><a href="#val-mix_hash_and_psk" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mix_hash_and_psk : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Noise/Public_key/index.html#type-t">Noise.Public_key.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Call <code class="code">mix_hash</code>, and if a PSK is used, call <code class="code">mix_key</code> as well.</p></div></div><div class="spec val" id="val-mix_key"><a href="#val-mix_key" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mix_key : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Call <code class="code">mix_key</code> on the underlying <code class="code">Symmetric_state.t</code> and initialize the
<code class="code">Cipher_state.t</code> with the result.</p></div></div><div class="spec val" id="val-mix_dh_key"><a href="#val-mix_dh_key" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mix_dh_key : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> local:<a href="index.html#type-key_type">key_type</a> <span class="keyword">&#8209;&gt;</span> remote:<a href="index.html#type-key_type">key_type</a> <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a>, string) Pervasives.result</code></div><div class="doc"><p>Perform a key exchange using the <code class="code">local</code> and <code class="code">remote</code> key types, and call
<code class="code">mix_key</code> using the result.</p></div></div><div class="spec val" id="val-mix_key_and_hash_psk"><a href="#val-mix_key_and_hash_psk" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mix_key_and_hash_psk : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a>, string) Pervasives.result</code></div><div class="doc"><p>Call <code class="code">Symmetric_state.mix_key_and_hash</code> with the PSK.</p></div></div><div class="spec val" id="val-decrypt_and_hash"><a href="#val-decrypt_and_hash" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>decrypt_and_hash : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a><span class="keyword"> * </span>Cstruct.t, string) Pervasives.result</code></div><div class="doc"></div></div><div class="spec val" id="val-encrypt_and_hash"><a href="#val-encrypt_and_hash" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>encrypt_and_hash : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a><span class="keyword"> * </span>Cstruct.t, string) Pervasives.result</code></div><div class="doc"></div></div><div class="spec val" id="val-handshake_hash"><a href="#val-handshake_hash" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>handshake_hash : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t option</code></div><div class="doc"><p>Get the handshake hash, if the handshake is over.</p></div></div><div class="spec val" id="val-split_dh"><a href="#val-split_dh" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>split_dh : ?&#8288;clear:bool <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> <a href="../Noise/Public_key/index.html#type-t">Noise.Public_key.t</a><span class="keyword"> * </span>Cstruct.t</code></div><div class="doc"><p>Extract a DH key at the beginning of the specified buffer.
The key size depends on whether it is expected to be encrypted or in clear.
</p><ul><li>if <code class="code">clear</code> is <code class="code">true</code> (it defaults to <code class="code">false</code>), assume it is clear</li><li>otherwise, depends on <code class="code">Cipher_state.has_key</code></li></ul></div></div><div class="spec val" id="val-setup_transport"><a href="#val-setup_transport" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>setup_transport : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Call <code class="code">Symmetric_state.split</code> and setup a one-way or two-way transport
depending on the pattern.</p></div></div><div class="spec val" id="val-receive_transport"><a href="#val-receive_transport" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>receive_transport : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a><span class="keyword"> * </span>Cstruct.t, string) Pervasives.result</code></div><div class="doc"><p>Receive a message, based on the configured transport.</p></div></div><div class="spec val" id="val-send_transport"><a href="#val-send_transport" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>send_transport : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a><span class="keyword"> * </span>Cstruct.t, string) Pervasives.result</code></div><div class="doc"><p>Send a message, based on the configured transport.</p></div></div><div class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>state</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-state.Handshake_step" class="anchored"><td class="def constructor"><a href="#type-state.Handshake_step" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Handshake_step</span><span class="keyword"> of </span><a href="../Noise/Pattern/index.html#type-step">Noise.Pattern.step</a> list<span class="keyword"> * </span>bool</code></td><td class="doc"><p>(** Next steps, and is it the last message *)</p></td></tr><tr id="type-state.Transport" class="anchored"><td class="def constructor"><a href="#type-state.Transport" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Transport</span></code></td><td class="doc"><p>(** Handshake is over *)</p></td></tr></table><code></code></div><div class="doc"></div></div><div class="spec val" id="val-next"><a href="#val-next" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>next : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a><span class="keyword"> * </span><a href="index.html#type-state">state</a></code></div><div class="doc"><p>Determine the next step, &quot;popping&quot; the next list of handshake steps.</p></div></div></body></html>